{% extends "base.html" %}

{% block title %}Movimentações de Estoque - Própolis do Frei{% endblock %}

{% block breadcrumbs %}
<span style="color: #a3a3a3;">Início / </span> <span style="font-weight: 600;">Estoque</span>
{% endblock %}

{% block content %}
<div class="flex-col gap-6">
    <div class="flex justify-between items-center">
        <div>
            <h1 style="font-size: 1.875rem; font-weight: 700;">Histórico de Movimentações</h1>
            <p style="color: #666;">Registro completo de entradas, saídas e ajustes de estoque.</p>
        </div>
        <a href="{% url 'movement_create' %}" class="btn btn-primary">
            <i data-lucide="arrow-left-right"></i> Nova Movimentação
        </a>
    </div>

    <div class="card">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="border-bottom: 1px solid var(--border); text-align: left;">
                    <th style="padding: 1rem; font-size: 0.875rem; color: #666;">Data/Hora</th>
                    <th style="padding: 1rem; font-size: 0.875rem; color: #666;">Tipo</th>
                    <th style="padding: 1rem; font-size: 0.875rem; color: #666;">Produto</th>
                    <th style="padding: 1rem; font-size: 0.875rem; color: #666;">Unidade</th>
                    <th style="padding: 1rem; font-size: 0.875rem; color: #666;">Quantidade</th>
                    <th style="padding: 1rem; font-size: 0.875rem; color: #666;">Usuário</th>
                </tr>
            </thead>
            <tbody>
                {% for move in movements %}
                <tr style="border-bottom: 1px solid var(--sidebar-accent);">
                    <td style="padding: 1rem; font-size: 0.875rem;">{{ move.created_at|date:"d/m/Y H:i" }}</td>
                    <td style="padding: 1rem;">
                        <span
                            style="padding: 0.25rem 0.5rem; border-radius: 99px; font-size: 0.75rem; font-weight: 600; background: {% if move.movement_type in 'entry,adjustment_plus,reversal_out' %}#dcfce7; color: #166534{% elif move.movement_type in 'exit,adjustment_minus,reversal_in' %}#fee2e2; color: #991b1b{% else %}#fef3c7; color: #92400e{% endif %};">
                            {{ move.get_movement_type_display }}
                        </span>
                    </td>
                    <td style="padding: 1rem; font-weight: 600;">{{ move.product.name }}</td>
                    <td style="padding: 1rem;">{{ move.establishment.name }}</td>
                    <td style="padding: 1rem; font-weight: 700;">
                        {% if move.movement_type in 'entry,adjustment_plus,reversal_out' %}
                        +
                        {% elif move.movement_type in 'exit,adjustment_minus,reversal_in' %}
                        -
                        {% endif %}
                        {{ move.quantity }}
                    </td>
                    <td style="padding: 1rem; font-size: 0.875rem; color: #666;">
                        {{ move.user.get_full_name|default:move.user.username }}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" style="padding: 3rem; text-align: center; color: #a3a3a3;">
                        Nenhuma movimentação registrada.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}